name: test
on: [push, pull_request]

jobs:
  tests:
    name: test
    strategy:
      matrix:
        version: ${{ fromJson('"[{ name: \\"some1\\", path: [1,2,3,4] },{ name: \\"some1\\", path: [1,2,3,4] }]"') }}
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
      
      - name: Install yq - yaml parser
        run: sudo snap install yq
      
      - name: read temp length
        id: read-temp-len
        run: yq '."upgrade-version"' .github/upgrade-test-configuration.yml
      
      - name: read length
        id: read-len
        run: >
            echo "::set-output name=items::$(
              yq '."upgrade-version"' .github/upgrade-test-configuration.yml
            )"
          
      - name: do changes
        id: do-changes
        run: |
          echo "    # Test to print Act 1\n    - name:  Test if true\n      if: always() && inputs.username\n      run: echo 'It is True'\n      shell: bash"  >> ./.github/composite-actions/act1/action.yml
        shell: bash
        
      - name: print changes
        run: | 
          cat .github/composite-actions/act1/action.yml
          echo ${{ matrix.version }}
          
      - name: read
        id: read
        run: yq '."13.4".engine_branch' .github/version-branch-template.yml
        
      - name: act test
        id: act-test
        uses: ./.github/composite-actions/act2
        
      - name: final
        id: final 
        run: echo "done"
